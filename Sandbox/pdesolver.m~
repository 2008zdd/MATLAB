function []=pdesolver(n)
[D,x]=chebD(n);
D2=D*D; %D2=D2(2:end-1,2:end-1);
D2([1 end],:)=0; D2([1 end])=1;

[xx, yy]=meshgrid(x);
F=sin(pi*xx).*cos(pi*yy); %F=F(2:end-1,2:end-1);

I=zeros(n); I(2:end-1,2:end-1)=eye(n-2);
X=zeros(n);
[Q, U]=schur(D2);
FF=Q'*F*Q;
for i=n:-1:1
    UU=(U+U(i,i)*I);
    
    X(:, i)=UU\(FF(:,i)-X(:,i+1:end)*U(i,i+1:end)');
end
X=Q*X*Q';

%disp(norm(D2*X+X*D2'-F, 'fro'))
%uu=zeros(n+2); uu(2:end-1,2:end-1)=X;
uu=X;
figure(2);
surf(xx,yy,uu);
end