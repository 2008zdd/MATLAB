<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>NFFT: fastsum.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">NFFT
   &#160;<span id="projectnumber">3.3.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">fastsum.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="fastsum_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * Copyright (c) 2002, 2016 Jens Keiner, Stefan Kunis, Daniel Potts</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * This program is free software; you can redistribute it and/or modify it under</span>
<a name="l00005"></a>00005 <span class="comment"> * the terms of the GNU General Public License as published by the Free Software</span>
<a name="l00006"></a>00006 <span class="comment"> * Foundation; either version 2 of the License, or (at your option) any later</span>
<a name="l00007"></a>00007 <span class="comment"> * version.</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * This program is distributed in the hope that it will be useful, but WITHOUT</span>
<a name="l00010"></a>00010 <span class="comment"> * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</span>
<a name="l00011"></a>00011 <span class="comment"> * FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more</span>
<a name="l00012"></a>00012 <span class="comment"> * details.</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> * You should have received a copy of the GNU General Public License along with</span>
<a name="l00015"></a>00015 <span class="comment"> * this program; if not, write to the Free Software Foundation, Inc., 51</span>
<a name="l00016"></a>00016 <span class="comment"> * Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</span>
<a name="l00017"></a>00017 <span class="comment"> */</span>
<a name="l00018"></a>00018 
<a name="l00036"></a>00036 <span class="preprocessor">#ifndef fastsum_h_inc</span>
<a name="l00037"></a>00037 <span class="preprocessor"></span><span class="preprocessor">#define fastsum_h_inc</span>
<a name="l00038"></a>00038 <span class="preprocessor"></span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;config.h&quot;</span>
<a name="l00040"></a>00040 
<a name="l00042"></a>00042 <span class="preprocessor">#ifdef HAVE_COMPLEX_H</span>
<a name="l00043"></a>00043 <span class="preprocessor"></span><span class="preprocessor">#include &lt;complex.h&gt;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#endif</span>
<a name="l00045"></a>00045 <span class="preprocessor"></span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;<a class="code" href="nfft3_8h.html">nfft3.h</a>&quot;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;infft.h&quot;</span>
<a name="l00049"></a>00049 
<a name="l00050"></a>00050 <span class="preprocessor">#undef X</span>
<a name="l00051"></a><a class="code" href="group__applications__fastsum.html#ga826edd40636cbaa44266b97c8c6a4fa3">00051</a> <span class="preprocessor"></span><span class="preprocessor">#define X(name) NFFT(name)</span>
<a name="l00052"></a>00052 <span class="preprocessor"></span>
<a name="l00053"></a>00053 <span class="preprocessor">#if !(defined(NF_LIN) || defined(NF_QUADR) || defined(NF_KUB))</span>
<a name="l00054"></a>00054 <span class="preprocessor"></span><span class="preprocessor">  #define NF_KUB</span>
<a name="l00055"></a>00055 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00056"></a>00056 <span class="preprocessor"></span>
<a name="l00057"></a>00057 <span class="preprocessor">#ifdef __cplusplus</span>
<a name="l00058"></a>00058 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span>
<a name="l00059"></a>00059 {
<a name="l00060"></a>00060 <span class="preprocessor">#endif </span><span class="comment">/* __cplusplus */</span>
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="keyword">typedef</span> C (*kernel)(R , int , <span class="keyword">const</span> R *);
<a name="l00063"></a>00063 
<a name="l00067"></a><a class="code" href="group__applications__fastsum.html#gac22376cb30edef9131c592a355d1030d">00067</a> <span class="preprocessor">#define EXACT_NEARFIELD  (1U&lt;&lt; 0)</span>
<a name="l00068"></a>00068 <span class="preprocessor"></span>
<a name="l00069"></a>00069 <span class="preprocessor">#define NEARFIELD_BOXES (1U&lt;&lt; 1)</span>
<a name="l00070"></a>00070 <span class="preprocessor"></span>
<a name="l00072"></a><a class="code" href="structfastsum__plan__.html">00072</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structfastsum__plan__.html" title="plan for fast summation algorithm">fastsum_plan_</a>
<a name="l00073"></a>00073 {
<a name="l00076"></a><a class="code" href="structfastsum__plan__.html#ad70ee163a195c108d0a5510a8407a307">00076</a>   <span class="keywordtype">int</span> <a class="code" href="structfastsum__plan__.html#ad70ee163a195c108d0a5510a8407a307" title="api">d</a>;                                
<a name="l00078"></a><a class="code" href="structfastsum__plan__.html#a179b7193adbfbecb48c91c11c42b2976">00078</a>   <span class="keywordtype">int</span> <a class="code" href="structfastsum__plan__.html#a179b7193adbfbecb48c91c11c42b2976" title="number of source knots">N_total</a>;                          
<a name="l00079"></a><a class="code" href="structfastsum__plan__.html#a1e80d12f6ed1d6a310dbd4fc429e6a2f">00079</a>   <span class="keywordtype">int</span> <a class="code" href="structfastsum__plan__.html#a1e80d12f6ed1d6a310dbd4fc429e6a2f" title="number of target knots">M_total</a>;                          
<a name="l00081"></a><a class="code" href="structfastsum__plan__.html#a96aa4ad70137dc0c6438887dd40614b1">00081</a>   C *<a class="code" href="structfastsum__plan__.html#a96aa4ad70137dc0c6438887dd40614b1" title="source coefficients">alpha</a>;                       
<a name="l00082"></a><a class="code" href="structfastsum__plan__.html#a9666d529e2959227e8bcdd61f82528f9">00082</a>   C *<a class="code" href="structfastsum__plan__.html#a9666d529e2959227e8bcdd61f82528f9" title="target evaluations">f</a>;                           
<a name="l00084"></a><a class="code" href="structfastsum__plan__.html#a4cedbda923773e136c482d9af234b7d0">00084</a>   R *<a class="code" href="structfastsum__plan__.html#a4cedbda923773e136c482d9af234b7d0" title="source knots in d-ball with radius 1/4-eps_b/2">x</a>;                            
<a name="l00085"></a><a class="code" href="structfastsum__plan__.html#afb7359a87b751e11f5b77e58325cf697">00085</a>   R *<a class="code" href="structfastsum__plan__.html#afb7359a87b751e11f5b77e58325cf697" title="target knots in d-ball with radius 1/4-eps_b/2">y</a>;                            
<a name="l00087"></a><a class="code" href="structfastsum__plan__.html#aaf4ea39f8bed50a000d83eec53ee42b8">00087</a>   kernel <a class="code" href="structfastsum__plan__.html#aaf4ea39f8bed50a000d83eec53ee42b8" title="kernel function">k</a>;  
<a name="l00088"></a><a class="code" href="structfastsum__plan__.html#a2f57e2c602bdf72644590e90fc07264a">00088</a>   R *<a class="code" href="structfastsum__plan__.html#a2f57e2c602bdf72644590e90fc07264a" title="parameters for kernel function">kernel_param</a>;                 
<a name="l00090"></a><a class="code" href="structfastsum__plan__.html#ab8680533cc667f052c9c83275e0756fa">00090</a>   <span class="keywordtype">unsigned</span> <a class="code" href="structfastsum__plan__.html#ab8680533cc667f052c9c83275e0756fa" title="flags precomp.">flags</a>;                       
<a name="l00095"></a><a class="code" href="structfastsum__plan__.html#abb4a9dc73722c3920d73bfaefd2affdf">00095</a>   C *<a class="code" href="structfastsum__plan__.html#abb4a9dc73722c3920d73bfaefd2affdf" title="internal">pre_K</a>;                       
<a name="l00098"></a><a class="code" href="structfastsum__plan__.html#a271a9a4e952484997e902c5cbd5ff084">00098</a>   <span class="keywordtype">int</span> <a class="code" href="structfastsum__plan__.html#a271a9a4e952484997e902c5cbd5ff084" title="FS__ - fast summation.">n</a>;                                
<a name="l00099"></a><a class="code" href="structfastsum__plan__.html#a7a976db9b36131c4bea0ba2c90be9119">00099</a>   C *<a class="code" href="structfastsum__plan__.html#a7a976db9b36131c4bea0ba2c90be9119" title="expansion coefficients">b</a>;                      
<a name="l00101"></a><a class="code" href="structfastsum__plan__.html#a236982e68b9354c7edb47eeff18e05bf">00101</a>   <span class="keywordtype">int</span> <a class="code" href="structfastsum__plan__.html#a236982e68b9354c7edb47eeff18e05bf" title="degree of smoothness of regularization">p</a>;                                
<a name="l00102"></a><a class="code" href="structfastsum__plan__.html#aff41332f42a4f22450c6e0748f9e1432">00102</a>   R <a class="code" href="structfastsum__plan__.html#aff41332f42a4f22450c6e0748f9e1432" title="inner boundary">eps_I</a>;                           <span class="comment">/* fixed to p/n so far  */</span>
<a name="l00103"></a><a class="code" href="structfastsum__plan__.html#a97e40c8514a1b2b86de2e5532f875c5b">00103</a>   R <a class="code" href="structfastsum__plan__.html#a97e40c8514a1b2b86de2e5532f875c5b" title="outer boundary">eps_B</a>;                           <span class="comment">/* fixed to 1/16 so far */</span>
<a name="l00104"></a>00104 
<a name="l00105"></a>00105   <a class="code" href="group__applications__fastsum.html#ga826edd40636cbaa44266b97c8c6a4fa3" title="Include header for C99 complex datatype.">X</a>(plan) mv1;                        
<a name="l00106"></a>00106   <a class="code" href="group__applications__fastsum.html#ga826edd40636cbaa44266b97c8c6a4fa3" title="Include header for C99 complex datatype.">X</a>(plan) mv2;                        
<a name="l00109"></a><a class="code" href="structfastsum__plan__.html#a29d4d3dc57d0b1713444efcfddf1b5ef">00109</a>   <span class="keywordtype">int</span> <a class="code" href="structfastsum__plan__.html#a29d4d3dc57d0b1713444efcfddf1b5ef" title="near field">Ad</a>;                               
<a name="l00110"></a><a class="code" href="structfastsum__plan__.html#abc039879bb29d9eae051fbac46827f79">00110</a>   C *<a class="code" href="structfastsum__plan__.html#abc039879bb29d9eae051fbac46827f79" title="spline values">Add</a>;                 
<a name="l00112"></a>00112   <span class="comment">/* things for computing *b - are they used only once?? */</span>
<a name="l00113"></a>00113   FFTW(plan) fft_plan;
<a name="l00114"></a>00114 
<a name="l00115"></a>00115   <span class="keywordtype">int</span> box_count;
<a name="l00116"></a>00116   <span class="keywordtype">int</span> box_count_per_dim;
<a name="l00117"></a>00117   <span class="keywordtype">int</span> *box_offset;
<a name="l00118"></a>00118   R *box_x;
<a name="l00119"></a>00119   C *box_alpha;
<a name="l00120"></a>00120 
<a name="l00121"></a><a class="code" href="structfastsum__plan__.html#a794d16be3bcb31e8d7a1fc012289da4d">00121</a>   R <a class="code" href="structfastsum__plan__.html#a794d16be3bcb31e8d7a1fc012289da4d" title="Measured time for each step if MEASURE_TIME is set.">MEASURE_TIME_t</a>[8]; 
<a name="l00122"></a>00122 } <a class="code" href="structfastsum__plan__.html" title="plan for fast summation algorithm">fastsum_plan</a>;
<a name="l00123"></a>00123 
<a name="l00140"></a>00140 <span class="keywordtype">void</span> <a class="code" href="group__applications__fastsum.html#ga4892832b81aaae7dd2e0e088043ee2a2" title="initialization of fastsum plan">fastsum_init_guru</a>(<a class="code" href="structfastsum__plan__.html" title="plan for fast summation algorithm">fastsum_plan</a> *ths, <span class="keywordtype">int</span> <a class="code" href="structfastsum__plan__.html#ad70ee163a195c108d0a5510a8407a307" title="api">d</a>, <span class="keywordtype">int</span> <a class="code" href="structfastsum__plan__.html#a179b7193adbfbecb48c91c11c42b2976" title="number of source knots">N_total</a>, <span class="keywordtype">int</span> <a class="code" href="structfastsum__plan__.html#a1e80d12f6ed1d6a310dbd4fc429e6a2f" title="number of target knots">M_total</a>, kernel <a class="code" href="structfastsum__plan__.html#aaf4ea39f8bed50a000d83eec53ee42b8" title="kernel function">k</a>, R *param, <span class="keywordtype">unsigned</span> <a class="code" href="structfastsum__plan__.html#ab8680533cc667f052c9c83275e0756fa" title="flags precomp.">flags</a>, <span class="keywordtype">int</span> nn, <span class="keywordtype">int</span> m, <span class="keywordtype">int</span> <a class="code" href="structfastsum__plan__.html#a236982e68b9354c7edb47eeff18e05bf" title="degree of smoothness of regularization">p</a>, R <a class="code" href="structfastsum__plan__.html#aff41332f42a4f22450c6e0748f9e1432" title="inner boundary">eps_I</a>, R <a class="code" href="structfastsum__plan__.html#a97e40c8514a1b2b86de2e5532f875c5b" title="outer boundary">eps_B</a>);
<a name="l00141"></a>00141 
<a name="l00146"></a>00146 <span class="keywordtype">void</span> <a class="code" href="group__applications__fastsum.html#gab989ea4659fe681bd4c025e82756f769" title="finalization of fastsum plan">fastsum_finalize</a>(<a class="code" href="structfastsum__plan__.html" title="plan for fast summation algorithm">fastsum_plan</a> *ths);
<a name="l00147"></a>00147 
<a name="l00152"></a>00152 <span class="keywordtype">void</span> <a class="code" href="group__applications__fastsum.html#gaaee3dd954ffc99e4330fabe16ccad0fd" title="direct computation of sums">fastsum_exact</a>(<a class="code" href="structfastsum__plan__.html" title="plan for fast summation algorithm">fastsum_plan</a> *ths);
<a name="l00153"></a>00153 
<a name="l00158"></a>00158 <span class="keywordtype">void</span> <a class="code" href="group__applications__fastsum.html#ga197c16fcec7935886fc97d140f2b20ff" title="precomputation for fastsum">fastsum_precompute</a>(<a class="code" href="structfastsum__plan__.html" title="plan for fast summation algorithm">fastsum_plan</a> *ths);
<a name="l00159"></a>00159 
<a name="l00164"></a>00164 <span class="keywordtype">void</span> <a class="code" href="group__applications__fastsum.html#gaab2cc691ba59064c18d439c9fd2185e8" title="fast NFFT-based summation">fastsum_trafo</a>(<a class="code" href="structfastsum__plan__.html" title="plan for fast summation algorithm">fastsum_plan</a> *ths);
<a name="l00165"></a>00165 <span class="comment">/* \} */</span>
<a name="l00166"></a>00166 
<a name="l00167"></a>00167 C <a class="code" href="group__applications__fastsum.html#gac2308141cb9d43efd6c44a04a1dcaab0" title="regularized kernel with K_I arbitrary and K_B smooth to zero">regkern</a>(kernel k, R xx, <span class="keywordtype">int</span> p, const R *param, R a, R <a class="code" href="structfastsum__plan__.html#a7a976db9b36131c4bea0ba2c90be9119" title="expansion coefficients">b</a>);
<a name="l00168"></a>00168 
<a name="l00170"></a>00170 C <a class="code" href="group__applications__fastsum.html#gaf2cbca475ce9688ffa19c9df96f47283" title="linear spline interpolation in near field with even kernels">kubintkern</a>(const R <a class="code" href="structfastsum__plan__.html#a4cedbda923773e136c482d9af234b7d0" title="source knots in d-ball with radius 1/4-eps_b/2">x</a>, const C *Add,
<a name="l00171"></a>00171   const <span class="keywordtype">int</span> Ad, const R a);
<a name="l00172"></a>00172 
<a name="l00173"></a>00173 <span class="preprocessor">#ifdef __cplusplus</span>
<a name="l00174"></a>00174 <span class="preprocessor"></span>}  <span class="comment">/* extern &quot;C&quot; */</span>
<a name="l00175"></a>00175 <span class="preprocessor">#endif </span><span class="comment">/* __cplusplus */</span>
<a name="l00176"></a>00176 
<a name="l00177"></a>00177 <span class="preprocessor">#endif</span>
<a name="l00178"></a>00178 <span class="preprocessor"></span><span class="comment">/* fastsum.h */</span>
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Sun Apr 24 2016 14:52:01 for NFFT by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
