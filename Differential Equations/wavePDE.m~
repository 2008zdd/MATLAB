function u = wavePDE(N)
% Solves the wave equation in 2D
[xx,yy]=meshgrid(chebGrid(N));
u(:,:,1)=exp(-40*((xx-.4).^2+yy.^2));
u(:,:,2)=0;
dt=6/N^2;
h=surf(xx, yy, u, 'EdgeColor', 'none');
colormap(jet);
nframes=10000;
for i=1:nframes
    lap=;
    u_new=2*u-u_old+dt^2*lap;
    u_old=u; u=u_new;
    u([1 end],:)=0; u(:,[1 end])=0;
    if(mod(i,10)==1)
        set(h, 'ZData', u);
        drawnow;
    end
end
end

function v=partialTime(u)
v(:,:,1)=u(:,:,2);
v(:,:,2)=chebfftD2(u(:,:,1),1)+chebfftD2(u(:,:,1),2);
end

function u=solveRK4(u, dt)
% Time-stepping by Runge Kutta 4th order
k1=dt*partialTime(u,      Dx, Dy, Dz, nu);
k2=dt*partialTime(u+k1/2, Dx, Dy, Dz, nu);
k3=dt*partialTime(u+k2/2, Dx, Dy, Dz, nu);
k4=dt*partialTime(u+k3,   Dx, Dy, Dz, nu);
u=u+(k1+2*k2+2*k3+k4)/6;
end